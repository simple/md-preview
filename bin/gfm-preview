#!/usr/bin/env python
# -*- coding: utf-8 -*-
import os
import sys
path = os.path.join(os.path.dirname(__file__), '..')
sys.path.insert(0, path)
import gfm_preview


if len(sys.argv) < 2:
    sys.exit('Usage: %s markdown_doc_path' % sys.argv[0])

if not os.path.exists(sys.argv[1]):
    sys.exit('ERROR: file %s was not found!' % sys.argv[1])

mdfile_path = sys.argv[1]

username = os.environ.get('GITHUB_USERNAME', False)
token = os.environ.get('GITHUB_TOKEN', False)
if username and token:
    gfm_preview.github_login_with_token(username, token)

text = ''
with open(mdfile_path, 'r') as fd:
    text = fd.read()

html = gfm_preview.render_markdown(text)

gfm_preview.open_in_browser(html)
